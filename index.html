<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R6 Siege Map Ban</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="lobbyPage">
        <h1>R6 Siege Map Ban</h1>
        <label for="lobbyName">Enter Lobby Name:</label>
        <input type="text" id="lobbyName" placeholder="Enter lobby name...">
        <button onclick="joinOrCreateLobby()">Join/Create Lobby</button>
    </div>

    <div id="mapBanPage" style="display: none;">
        <h1>Map Ban</h1>
        <p>Current Player: <span id="currentPlayer"></span></p>
        <div id="mapContainer"></div>
        <button onclick="finalizeBans()">Finalize Bans</button>
    </div>

    <script>
        let lobby = null;
        let currentPlayer = null;
        let maps = ["Bank", "Border", "Chalet", "Clubhouse", "Coastline", "Consulate", "EmeraldPlains", "Favela", "Fortress", "Hereford", "House", "Kafe", "Kanal", "Lair", "Nighthaven", "Oregon", "Outback", "Plane", "Skyscraper", "Stadium", "Themepark", "Tower", "Villa", "Yacht"];

        function joinOrCreateLobby() {
            const lobbyName = document.getElementById("lobbyName").value.trim();
            if (!lobbyName) {
                alert("Please enter a lobby name.");
                return;
            }

            if (lobby && lobby.name === lobbyName) {
                alert("You are already in this lobby.");
                return;
            }

            // Check if a lobby with the same name already exists
            if (lobby && lobby.name !== lobbyName) {
                alert("A lobby with this name already exists. Please choose a different name.");
                return;
            }

            // Create a new lobby
            lobby = {
                name: lobbyName,
                players: [],
                bans: [],
                currentPlayerIndex: 0
            };

            document.getElementById("lobbyPage").style.display = "none";
            document.getElementById("mapBanPage").style.display = "block";
            updateUI();
        }

        function joinLobby() {
            if (!lobby) {
                alert("No lobby found. Please create a lobby first.");
                return;
            }

            const lobbyName = document.getElementById("lobbyName").value.trim();
            if (lobbyName !== lobby.name) {
                alert("Incorrect lobby name. Please enter the correct lobby name.");
                return;
            }

            if (lobby.players.length === 2) {
                alert("This lobby is already full.");
                return;
            }

            lobby.players.push(lobby.players.length + 1);

            if (lobby.players.length === 2) {
                startBanPhase();
            }
        }

        function startBanPhase() {
            currentPlayer = 0;
            updateUI();
        }

        function banMap(map) {
            if (!lobby || currentPlayer >= lobby.players.length) {
                return;
            }

            if (lobby.bans.includes(map)) {
                return;
            }

            lobby.bans.push(map);
            currentPlayer++;

            if (currentPlayer >= lobby.players.length) {
                finalizeBans();
            } else {
                updateUI();
            }
        }

        function updateUI() {
            document.getElementById("currentPlayer").textContent = `Player ${lobby.players[currentPlayer]}`;
            const mapContainer = document.getElementById("mapContainer");
            mapContainer.innerHTML = "";
            maps.forEach((map, index) => {
                if (!lobby.bans.includes(map)) {
                    const img = document.createElement("img");
                    img.src = `maps/${map}.jpg`; // Assuming you have images for each map in a 'maps' folder
                    img.alt = map;
                    img.onclick = () => banMap(map);
                    mapContainer.appendChild(img);
                }
            });
        }

        function finalizeBans() {
            alert("Bans finalized!");
            lobby = null;
            currentPlayer = null;
            document.getElementById("lobbyPage").style.display = "block";
            document.getElementById("mapBanPage").style.display = "none";
        }
    </script>
</body>

</html>
